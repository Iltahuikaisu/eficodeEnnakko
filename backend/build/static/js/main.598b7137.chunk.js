(this.webpackJsonpfront=this.webpackJsonpfront||[]).push([[0],{30:function(e,t,a){e.exports=a(56)},35:function(e,t,a){},56:function(e,t,a){"use strict";a.r(t);var n=a(3),r=a.n(n),i=a(23),o=a.n(i),s=(a(35),a(24)),l=a(6),d=a(11),u=a(25),c=a.n(u),m=function(e){return c.a.get("http://api.digitransit.fi/geocoding/v1/search?text=".concat(e,"&sources=oa"))},f=function(e){var t=e.route,a=e.destination,n=t.reduce((function(e,t){var n,r,i,o=new Date(t.startTime).toLocaleTimeString(void 0,{hourCycle:"h24",timeStyle:"short",hour:"2-digit",minute:"2-digit"}),s=new Date(t.endTime).toLocaleTimeString(void 0,{hourCycle:"h24",timeStyle:"short",hour:"2-digit",minute:"2-digit"});return i=t.route?t.mode.toLowerCase()+" "+t.route.shortName:"walk",r="Origin"===t.from.name?"Eficode":t.from.name,n="Destination"===t.to.name?"Destination":t.to.name,"Eficode"===r&&"Destination"===n?"Leave by "+o+" and walk to "+a.name+". Arrival at "+s:"Eficode"===r?"Leave by "+o+" and walk to "+n+" then ":"Destination"===n?e+" walk to destination. Arrival at "+s:e+" to "+n+" by "+i+", then "}),"");return r.a.createElement(r.a.Fragment,null,n)},g=function(e){var t=e.listOfItineraries,a=e.start,n=e.destination;if(!t)return r.a.createElement(r.a.Fragment,null);var i=t.map((function(e){return r.a.createElement("li",{key:e.legs[0].startTime},r.a.createElement(f,{route:e.legs,destination:n,start:a}))}));return r.a.createElement(r.a.Fragment,null,i)},E=function(e){var t=Object(n.useState)(e.time),a=Object(l.a)(t,2),i=a[0],o=a[1],s=1;return Object(n.useEffect)((function(){return s=setInterval((function(){return function(e){e.setTimer((function(e){return e<=-5e3&&(alert("you should run now"),window.location.reload()),e-1e3}))}({timer:i,setTimer:o})}),1e3),function(){clearInterval(s)}}),[s]),r.a.createElement("div",null,Math.floor(Math.abs(i/6e4))+":"+Math.floor(i/1e3)%60)};function h(){var e=Object(s.a)(["{\n  plan(\n    from: {lat: ",", lon: ","}\n    to: {lat: ",", lon: ","}\n    numItineraries: 5\n  ) {\n    itineraries {\n      legs {\n        startTime\n        from {\n            name\n        }\n        to {\n            name\n        }\n        agency {\n            name\n        }\n        route {\n            shortName\n            longName\n        }\n        endTime\n        mode\n        duration\n        realTime\n        distance\n        transitLeg\n      }\n    }\n  }\n}"]);return h=function(){return e},e}var v=new d.a({uri:"https://api.digitransit.fi/routing/v1/routers/hsl/index/graphql"}),S=function(e){e.dataSetters.setRouteAddresses((function(t){return"Eficode"===e.dataSetters.routeAddresses.start.name?{end:{address:e.dataSetters.newDestination,name:e.dataSetters.newDestination},start:{address:t.start.address,name:t.start.name}}:{start:{address:e.dataSetters.newDestination,name:e.dataSetters.newDestination},end:{address:t.start.address,name:t.start.name}}})),e.dataSetters.newStartPlaceData(void 0),e.dataSetters.newEndPlaceData(void 0),e.dataSetters.newData(void 0)},b=function(){var e=Object(n.useState)(),t=Object(l.a)(e,2),a=t[0],i=t[1],o=Object(n.useState)(),s=Object(l.a)(o,2),u=s[0],c=s[1],f=Object(n.useState)(),b=Object(l.a)(f,2),w=b[0],p=b[1],k=Object(n.useState)(),j=Object(l.a)(k,2),D=j[0],O=j[1],y=Object(n.useState)(),T=Object(l.a)(y,2),C=T[0],P=T[1],A=Object(n.useState)(!1),L=Object(l.a)(A,2),R=L[0],H=L[1],I=Object(n.useState)({start:{address:"Pohjoinen Rautatiekatu 25, Helsinki",name:"Eficode"},end:{address:"M\xe4nnikk\xf6tie 6, Helsinki",name:"Maunulan kotipizza"}}),M=Object(l.a)(I,2),q=M[0],F=M[1],N={newData:i,newStartPlaceData:c,newDestinationPlaceData:p,newWaitTime:O,setRouteAddresses:F,newDestination:C,routeAddresses:q,newEndPlaceData:p};return Object(n.useEffect)((function(){u&&w&&"loading"!==u&&"loading"!==w&&v.query({query:Object(d.b)(h(),u.lat,u.lon,w.lat,w.lon)}).then((function(e){console.log(e),e.data.plan.itineraries[0]?(O(e.data.plan.itineraries[0].legs[0].startTime-(new Date).getTime()),H(!1)):H(!0),i(e)}))}),[u,w]),Object(n.useEffect)((function(){c("loading"),p("loading"),m(q.start.address).then((function(e){var t;console.log(e),t="Pohjoinen Rautatiekatu 25, Helsinki"===q.start.address?"Eficode":e.data.features[0].properties.name,c({lon:e.data.features[0].geometry.coordinates[0],lat:e.data.features[0].geometry.coordinates[1],name:t})})),p("loading"),m(q.end.address).then((function(e){var t;console.log(e),t="Pohjoinen Rautatiekatu 25, Helsinki"===q.end.address?"Eficode":e.data.features[0].properties.name,p({lon:e.data.features[0].geometry.coordinates[0],lat:e.data.features[0].geometry.coordinates[1],name:t})}))}),[q]),R?r.a.createElement("div",null,r.a.createElement("h3",null,"Change the non-Eficode destination"),r.a.createElement("form",null,r.a.createElement("input",{onChange:function(e){P(e.target.value)}}),r.a.createElement("button",{onClick:function(e){e.preventDefault(),S({dataSetters:N})}},"Submit"),r.a.createElement("div",null,C),r.a.createElement("h3",null,"Error in input, try again"),r.a.createElement("p",null,"Working formula is 'Nameoftheroad 42, Helsinki' Please don't ask route to places HSL will not take you."))):a&&"queryStarted"!==a?r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Change the non-Eficode destination"),r.a.createElement("form",null,r.a.createElement("input",{onChange:function(e){P(e.target.value)}}),r.a.createElement("button",{onClick:function(){return S({dataSetters:N})}},"Submit")),r.a.createElement("div",null,r.a.createElement("h3",null,"Reverse the route"),r.a.createElement("button",{onClick:function(){return(e={dataSetters:N}).dataSetters.setRouteAddresses((function(e){return{start:{address:e.end.address,name:e.end.name},end:{address:e.start.address,name:e.start.name}}})),e.dataSetters.newStartPlaceData(void 0),e.dataSetters.newEndPlaceData(void 0),void e.dataSetters.newData(void 0);var e}},"Change"),r.a.createElement("h3",null,"Timetables from ".concat(u.name," to ").concat(w.name)),r.a.createElement(E,{time:D,dataSetters:N})),r.a.createElement("div",null,r.a.createElement(g,{listOfItineraries:a.data.plan.itineraries,setWaitTime:O,waitTime:D,start:u,destination:w}))):r.a.createElement("div",null,"loading")};var w=function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Eficode ennakko"),r.a.createElement(b,null))};o.a.render(r.a.createElement(w,null),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.598b7137.chunk.js.map